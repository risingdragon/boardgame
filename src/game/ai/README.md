# Blokus AI 策略

本文档提供对方块游戏(Blokus)中 AI 决策策略的分析。

## 概述

AI 被设计为在游戏的不同阶段采用不同的优先策略进行决策。它使用全面的评分系统来评估潜在的落子，权衡包括棋子大小、位置价值、棋盘控制和防御考量等多种因素。

## 组件结构

- **AIPlayer**: 主要的 AI 控制器，负责最终的移动决策
- **BoardAnalyzer**: 分析棋盘状态以识别战略机会
- **MoveEvaluator**: 基于多种战略因素对可能的移动进行评分和排名
- **PieceUtilities**: 提供棋子操作的辅助功能

## 战略决策制定

### 游戏阶段适应

AI 根据游戏进程调整其策略：

1. **开局阶段（第一步）**
   - 随机选择一个5方块大小的棋子，让开局更加丰富多样
   - 从多个高分候选放置方案中随机选择，增加游戏变化
   - 偏好具有良好扩展潜力的位置
   - 重视靠近棋盘中心的位置

2. **早期游戏（进度 < 0.3）**
   - 继续优先考虑大棋子
   - 避开棋盘边缘以保持最大灵活性
   - 强烈避免使用 1x1 棋子

3. **中期游戏（进度 0.3-0.7）**
   - 平衡进攻性扩展和防御性阻挡
   - 开始考虑对手的连接点
   - 仍然偏好大棋子，但更愿意使用中等大小的棋子

4. **后期游戏（进度 > 0.7）**
   - 更愿意使用小棋子，包括 1x1 棋子
   - 高度重视阻挡对手的移动
   - 专注于高效填充小型空白区域

### 区域分析

AI 识别并分类棋盘上的空白区域：

- **大型空白区域**：优先用于扩展机会
- **小型区域（1x2, 2x1）**：匹配适当大小的棋子
- **竞争区域**：双方玩家都可以放置棋子的区域

`findEmptyRegions` 方法识别各种大小的区域，并为其分配一个"扩展潜力"分数，影响放置决策。

### 棋子与区域匹配

AI 的一个关键优势是将棋子大小与可用空间匹配：

- 对于小区域（1x2, 2x1），AI 强烈偏好与区域大小匹配的棋子
- 对于较大区域，AI 优先使用较大棋子以提高效率
- AI 计算"大小匹配"得分，奖励高效的空间利用

### 防御策略

AI 通过以下方式实施防御策略：

- **连接点分析**：识别并阻断对手潜在的连接点
- **领土控制**：占领战略区域以限制对手扩展
- **热点图生成**：基于战略价值对棋盘位置评分

### 评分系统

移动评估考虑多种因素：

1. **棋子大小**：通常偏好较大棋子（每平方+2分）
2. **扩展潜力**：允许未来放置的移动获得额外分数
3. **领土控制**：战略位置获得更高分数
4. **棋盘覆盖**：高效利用空间的移动得分更高
5. **防御价值**：阻断对手连接点（+15-25分）
6. **左侧偏好**：当左侧有更多空间时，在那里的放置获得+15分

## 特殊情况处理

### 第一步策略

第一步特殊处理，强调：

- 随机选择大小为5的棋子（最大的棋子）
- 从多个高分候选位置中随机选择一个
- 定位在靠近棋盘中心的位置
- 最大化未来扩展选项

### 空白区域利用

AI 具有复杂的空白区域检测：

- 识别小至 1x2 的区域
- 评估区域扩展潜力
- 跟踪已访问单元格以避免重复

### 备用策略

当找不到最佳移动时，AI 有备用策略：

- 尝试放置较小的棋子
- 放宽一些放置标准
- 确保在可能的情况下始终做出有效移动

## 性能优化

为确保快速决策：

- 优先评估最有前途的区域
- 早期过滤明显不适合区域的棋子
- 对顶级移动进行有限随机化，在保持质量的同时增加不可预测性

## 未来改进机会

潜在的改进领域：

- 更复杂的残局策略
- 改进棋子放置的模式识别
- 从过去的游戏中学习以调整策略
- 进一步优化防御性阻断策略
